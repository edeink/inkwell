var c=Object.defineProperty;var i=(o,e)=>c(o,"name",{value:e,configurable:!0});import{_ as h,C as r,c as g,o as p,j as t,G as l,ai as d,a as s}from"./chunks/framework.BnOgjZe9.js";const V=JSON.parse('{"title":"电子表格","description":"","frontmatter":{"title":"电子表格","sidebar_label":"电子表格"},"headers":[],"relativePath":"docs/demo/spreadsheet.md","filePath":"docs/demo/spreadsheet.md"}'),m={name:"docs/demo/spreadsheet.md"};function b(o,e,f,u,x,I){const a=r("InkCodeBlock"),n=r("InkMermaidBlock");return p(),g("div",null,[e[0]||(e[0]=t("p",null,"import { SpreadsheetDemoApp } from '@demo/spreadsheet/app';",-1)),e[1]||(e[1]=t("h1",{id:"电子表格",tabindex:"-1"},[s("电子表格 "),t("a",{class:"header-anchor",href:"#电子表格","aria-label":'Permalink to "电子表格"'},"​")],-1)),e[2]||(e[2]=t("p",null,"这是一个基于 Inkwell 框架实现的高性能电子表格示例，展示了如何处理大规模数据、复杂交互以及自定义布局逻辑。",-1)),e[3]||(e[3]=t("h2",{id:"在线演示",tabindex:"-1"},[s("在线演示 "),t("a",{class:"header-anchor",href:"#在线演示","aria-label":'Permalink to "在线演示"'},"​")],-1)),l(a,{"code-base64":"LyoqIEBqc3hJbXBvcnRTb3VyY2UgQC91dGlscy9jb21waWxlciAqLwo8U3ByZWFkc2hlZXREZW1vQXBwIHdpZHRoPXs2ODZ9IGhlaWdodD17NDAwfSAvPgo=",lang:"tsx",meta:"mode:edit height:400"}),e[4]||(e[4]=d('<h3 id="组件参数-props" tabindex="-1">组件参数 (Props) <a class="header-anchor" href="#组件参数-props" aria-label="Permalink to &quot;组件参数 (Props)&quot;">​</a></h3><table tabindex="0"><thead><tr><th style="text-align:left;">属性</th><th style="text-align:left;">类型</th><th style="text-align:left;">默认值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;"><code>width</code></td><td style="text-align:left;"><code>number</code></td><td style="text-align:left;"><code>800</code></td><td style="text-align:left;">表格总宽度</td></tr><tr><td style="text-align:left;"><code>height</code></td><td style="text-align:left;"><code>number</code></td><td style="text-align:left;"><code>600</code></td><td style="text-align:left;">表格总高度</td></tr><tr><td style="text-align:left;"><code>theme</code></td><td style="text-align:left;"><code>ThemePalette</code></td><td style="text-align:left;"><code>Themes.light</code></td><td style="text-align:left;">主题配置（支持深色模式）</td></tr><tr><td style="text-align:left;"><code>model</code></td><td style="text-align:left;"><code>SpreadsheetModel</code></td><td style="text-align:left;">-</td><td style="text-align:left;">外部传入的数据模型实例，用于受控模式</td></tr><tr><td style="text-align:left;"><code>dataVersion</code></td><td style="text-align:left;"><code>number</code></td><td style="text-align:left;">-</td><td style="text-align:left;">数据版本号，用于触发外部数据更新时的重绘</td></tr></tbody></table><h2 id="组件架构" tabindex="-1">组件架构 <a class="header-anchor" href="#组件架构" aria-label="Permalink to &quot;组件架构&quot;">​</a></h2>',3)),l(n,{"code-base64":"Z3JhcGggVEQKICAgIEFbU3ByZWFkc2hlZXREZW1vQXBwXSAtLT4gQltTcHJlYWRzaGVldF0KICAgIEIgLS0+IENbU3RhY2tdCiAgICBDIC0tPiBEW0Nvcm5lckhlYWRlcl0KICAgIEMgLS0+IEVbQ29sdW1uSGVhZGVyc10KICAgIEMgLS0+IEZbUm93SGVhZGVyc10KICAgIEMgLS0+IEdbU2Nyb2xsVmlld10KICAgIEcgLS0+IEhbU3ByZWFkc2hlZXRHcmlkXQogICAgSCAtLT4gSVtWaXNpYmxlIENlbGxzXQogICAgQyAtLT4gSltTcHJlYWRzaGVldEVkaXRhYmxlVGV4dF0K"}),e[5]||(e[5]=d('<h2 id="功能特性" tabindex="-1">功能特性 <a class="header-anchor" href="#功能特性" aria-label="Permalink to &quot;功能特性&quot;">​</a></h2><p>该示例实现了电子表格的核心功能，包括：</p><ol><li><p><strong>高性能渲染 (Virtualization)</strong></p><ul><li>采用虚拟滚动：只渲染视口（Viewport）内的单元格，避免随数据规模线性增长的节点数量。</li><li>使用 <code>ScrollView</code> 处理滚动逻辑，配合 <code>SpreadsheetGrid</code> 按需渲染可见区域。</li></ul></li><li><p><strong>数据模型 (Data Model)</strong></p><ul><li><strong>稀疏矩阵存储</strong>: 使用 <code>Map&lt;string, CellData&gt;</code> 存储单元格数据，避免为空白单元格分配内存。</li><li><strong>尺寸管理</strong>: 使用 <code>SizeManager</code> 高效管理行高和列宽，支持默认尺寸和自定义尺寸的混合查找（O(log N) 或 O(K)）。</li></ul></li><li><p><strong>交互操作</strong></p><ul><li><strong>单元格选择</strong>: 点击选择单个单元格，支持行列头部点击选中整行/整列。</li><li><strong>高效编辑</strong>: 双击单元格进入编辑模式。采用编辑器复用机制，支持快速连续编辑不同单元格，自动处理数据落盘与状态重置。</li><li><strong>调整尺寸</strong>: 拖拽行号或列标边缘调整行高/列宽。</li></ul></li></ol><h2 id="inkwell-最佳实践" tabindex="-1">Inkwell 最佳实践 <a class="header-anchor" href="#inkwell-最佳实践" aria-label="Permalink to &quot;Inkwell 最佳实践&quot;">​</a></h2><p>本示例展示了 Inkwell 框架在处理复杂数据类应用时的优势：</p><h3 id="_1-绝对定位布局-absolute-layout" tabindex="-1">1. 绝对定位布局 (Absolute Layout) <a class="header-anchor" href="#_1-绝对定位布局-absolute-layout" aria-label="Permalink to &quot;1. 绝对定位布局 (Absolute Layout)&quot;">​</a></h3><p>电子表格是一个典型的绝对定位场景。我们没有使用 Flex 布局，而是根据 <code>SizeManager</code> 计算出的 <code>offset</code> 直接控制每个单元格的 <code>left</code> 和 <code>top</code>。</p>',7)),l(a,{"code-base64":"Ly8g5Lyq5Luj56CB56S65L6LCmNvbnN0IHJvd1RvcCA9IG1vZGVsLmdldFJvd09mZnNldChyKTsKY29uc3QgY29sTGVmdCA9IG1vZGVsLmdldENvbE9mZnNldChjKTsKCjxQb3NpdGlvbmVkIGxlZnQ9e2NvbExlZnR9IHRvcD17cm93VG9wfSB3aWR0aD17d30gaGVpZ2h0PXtofT4KICA8Q2VsbCAvPgo8L1Bvc2l0aW9uZWQ+Cg==",lang:"typescript",meta:""}),e[6]||(e[6]=d('<h3 id="_2-状态分离与按需更新" tabindex="-1">2. 状态分离与按需更新 <a class="header-anchor" href="#_2-状态分离与按需更新" aria-label="Permalink to &quot;2. 状态分离与按需更新&quot;">​</a></h3><p>为了保证性能，我们将数据模型 (<code>SpreadsheetModel</code>) 与 UI 组件分离。</p><ul><li><code>Spreadsheet</code> 组件持有 Model 和 Viewport 状态（滚动位置）。</li><li><code>SpreadsheetGrid</code> 组件只负责根据当前视口渲染可见区域。</li></ul><h3 id="_3-事件处理" tabindex="-1">3. 事件处理 <a class="header-anchor" href="#_3-事件处理" aria-label="Permalink to &quot;3. 事件处理&quot;">​</a></h3><p>利用 Inkwell 的事件系统处理复杂的鼠标交互：</p><ul><li><code>onPointerDown</code>: 处理单元格选中和拖拽调整尺寸的开始。</li><li><code>onPointerMove</code>: 处理拖拽过程中的尺寸实时更新。</li><li><code>onPointerUp</code>: 结束拖拽操作。</li></ul><h3 id="_4-主题适配" tabindex="-1">4. 主题适配 <a class="header-anchor" href="#_4-主题适配" aria-label="Permalink to &quot;4. 主题适配&quot;">​</a></h3><p>通过 <code>ThemePalette</code> 接口实现深色模式的无缝切换，所有颜色值（背景、边框、文字）都从主题变量中获取，而非硬编码。</p>',8))])}i(b,"_sfc_render");const k=h(m,[["render",b]]);export{V as __pageData,k as default};
