import{_ as i,C as r,c as n,o as d,ai as t,G as l,j as a,a as c}from"./chunks/framework.Ckc8SVM3.js";const _=JSON.parse('{"title":"可编辑文本重构：Input 与 TextArea","description":"","frontmatter":{},"headers":[],"relativePath":"src/demo/editable-text/README.md","filePath":"src/demo/editable-text/README.md"}'),s={name:"src/demo/editable-text/README.md"};function g(u,e,h,b,p,m){const o=r("InkCodeBlock");return d(),n("div",null,[e[0]||(e[0]=t('<h1 id="可编辑文本重构-input-与-textarea" tabindex="-1">可编辑文本重构：Input 与 TextArea <a class="header-anchor" href="#可编辑文本重构-input-与-textarea" aria-label="Permalink to &quot;可编辑文本重构：Input 与 TextArea&quot;">​</a></h1><p>本文档概述了新的 <code>Input</code> 和 <code>TextArea</code> 组件的设计与实现，旨在替代 demo 中旧有的 <code>EditableText</code>。</p><h2 id="_1-设计概览" tabindex="-1">1. 设计概览 <a class="header-anchor" href="#_1-设计概览" aria-label="Permalink to &quot;1. 设计概览&quot;">​</a></h2><p>目标是提供类似 Flutter 的强大文本编辑能力，支持精确的布局控制、选区管理和滚动行为。</p><h3 id="架构" tabindex="-1">架构 <a class="header-anchor" href="#架构" aria-label="Permalink to &quot;架构&quot;">​</a></h3><ul><li><strong>框架</strong>: InkWell (基于 Canvas 的 UI)。</li><li><strong>基类</strong>: <code>StatefulWidget</code>。</li><li><strong>文本渲染</strong>: 使用核心 <code>Text</code> 组件和 <code>TextLayout</code>。</li><li><strong>滚动</strong>: 使用核心 <code>ScrollView</code> 组件。</li><li><strong>输入处理</strong>: 使用隐藏的 DOM <code>&lt;input&gt;</code> (用于 <code>Input</code>) 或 <code>&lt;textarea&gt;</code> (用于 <code>TextArea</code>) 来捕获键盘事件和输入法合成。</li></ul><h3 id="组件" tabindex="-1">组件 <a class="header-anchor" href="#组件" aria-label="Permalink to &quot;组件&quot;">​</a></h3><h4 id="input-单行输入" tabindex="-1"><code>Input</code> (单行输入) <a class="header-anchor" href="#input-单行输入" aria-label="Permalink to &quot;`Input` (单行输入)&quot;">​</a></h4><ul><li><strong>滚动</strong>: 仅水平滚动 (<code>enableBounceHorizontal: true</code>)。</li><li><strong>布局</strong>: 单行，不换行。</li><li><strong>DOM</strong>: <code>&lt;input type=&quot;text&quot;&gt;</code>。</li></ul><h4 id="textarea-多行输入" tabindex="-1"><code>TextArea</code> (多行输入) <a class="header-anchor" href="#textarea-多行输入" aria-label="Permalink to &quot;`TextArea` (多行输入)&quot;">​</a></h4><ul><li><strong>滚动</strong>: 仅垂直滚动 (<code>enableBounceVertical: true</code>)。</li><li><strong>布局</strong>: 多行，自动换行 (<code>maxLines: Infinity</code>)。</li><li><strong>DOM</strong>: <code>&lt;textarea&gt;</code>。</li></ul><h2 id="_2-核心功能" tabindex="-1">2. 核心功能 <a class="header-anchor" href="#_2-核心功能" aria-label="Permalink to &quot;2. 核心功能&quot;">​</a></h2><h3 id="_2-1-文本定位与布局" tabindex="-1">2.1 文本定位与布局 <a class="header-anchor" href="#_2-1-文本定位与布局" aria-label="Permalink to &quot;2.1 文本定位与布局&quot;">​</a></h3><ul><li><strong>点击测试</strong>: 将指针坐标（相对于组件）转换为文本索引，利用 <code>TextLayout</code> 逻辑。</li><li><strong>光标定位</strong>: <ul><li><code>ArrowLeft</code> / <code>ArrowRight</code>: 按字符移动。</li><li><code>ArrowUp</code> / <code>ArrowDown</code>: 按行移动（视觉垂直移动）。</li><li><code>Home</code> / <code>End</code>: 移动到行首/行尾。</li><li><code>Ctrl/Cmd + Home/End</code>: 移动到文档开头/结尾。</li></ul></li></ul><h3 id="_2-2-选区功能" tabindex="-1">2.2 选区功能 <a class="header-anchor" href="#_2-2-选区功能" aria-label="Permalink to &quot;2.2 选区功能&quot;">​</a></h3><ul><li><strong>视觉效果</strong>: 在文本<em>下方</em>绘制彩色矩形。</li><li><strong>交互</strong>: <ul><li><strong>鼠标拖拽</strong>: 根据指针位置更新选区起点和终点。</li><li><strong>键盘</strong>: <code>Shift + 方向键</code> 扩展或收缩选区。</li><li><strong>全选</strong>: <code>Ctrl/Cmd + A</code>。</li></ul></li></ul><h3 id="_2-3-滚动与视口" tabindex="-1">2.3 滚动与视口 <a class="header-anchor" href="#_2-3-滚动与视口" aria-label="Permalink to &quot;2.3 滚动与视口&quot;">​</a></h3><ul><li><strong>自动滚动</strong>: 当光标移动到可视视口之外时，<code>ScrollView</code> 自动滚动以确保光标可见。</li><li><strong>输入同步</strong>: 保持隐藏 DOM 元素与光标位置同步，以确保输入法候选窗口出现在正确位置（需要坐标映射）。</li></ul><h2 id="_3-实现细节" tabindex="-1">3. 实现细节 <a class="header-anchor" href="#_3-实现细节" aria-label="Permalink to &quot;3. 实现细节&quot;">​</a></h2><h3 id="状态管理" tabindex="-1">状态管理 <a class="header-anchor" href="#状态管理" aria-label="Permalink to &quot;状态管理&quot;">​</a></h3>',20)),l(o,{"code-base64":"aW50ZXJmYWNlIEVkaXRhYmxlU3RhdGUgewogIHRleHQ6IHN0cmluZzsKICBzZWxlY3Rpb25TdGFydDogbnVtYmVyOwogIHNlbGVjdGlvbkVuZDogbnVtYmVyOwogIGZvY3VzZWQ6IGJvb2xlYW47CiAgY3Vyc29yVmlzaWJsZTogYm9vbGVhbjsgLy8g55So5LqO6Zeq54OBCiAgLy8gLi4uCn0K",lang:"typescript",meta:""}),e[1]||(e[1]=a("h3",{id:"渲染结构",tabindex:"-1"},[c("渲染结构 "),a("a",{class:"header-anchor",href:"#渲染结构","aria-label":'Permalink to "渲染结构"'},"​")],-1)),l(o,{"code-base64":"PFNjcm9sbFZpZXc+CiAgPFN0YWNrPgogICAgey8qIDEuIOmAieWMuuWxgiAqL30KICAgIDxDdXN0b21QYWludCBwYWludGVyPXtTZWxlY3Rpb25QYWludGVyfSAvPgogICAgCiAgICB7LyogMi4g5paH5pys5bGCICovfQogICAgPFRleHQgcmVmPXt0aGlzLnRleHRSZWZ9IC8+CiAgICAKICAgIHsvKiAzLiDlhYnmoIflsYIgKi99CiAgICA8UG9zaXRpb25lZCA+CiAgICAgICA8Q29udGFpbmVyIGNvbG9yPXtjdXJzb3JDb2xvcn0gLz4KICAgIDwvUG9zaXRpb25lZD4KICA8L1N0YWNrPgo8L1Njcm9sbFZpZXc+Cg==",lang:"tsx",meta:""}),e[2]||(e[2]=t('<h3 id="事件处理" tabindex="-1">事件处理 <a class="header-anchor" href="#事件处理" aria-label="Permalink to &quot;事件处理&quot;">​</a></h3><ul><li><strong>指针事件</strong>: 由组件处理（down, move, up）以管理焦点和选区。</li><li><strong>键盘事件</strong>: 由隐藏 DOM 元素处理。组件监听隐藏元素的 <code>input</code>, <code>keydown</code> 等事件。</li></ul><h2 id="_4-测试策略" tabindex="-1">4. 测试策略 <a class="header-anchor" href="#_4-测试策略" aria-label="Permalink to &quot;4. 测试策略&quot;">​</a></h2><p>测试文件位于 <code>__tests__</code> 目录，覆盖以下内容：</p><ol><li><p><strong>渲染</strong>:</p><ul><li>Input 渲染初始值。</li><li>TextArea 渲染初始值。</li></ul></li><li><p><strong>交互</strong>:</p><ul><li>聚焦/失焦更新状态。</li><li>输入更新文本。</li><li>方向键移动光标。</li><li>Shift + 方向键更新选区。</li></ul></li><li><p><strong>滚动</strong>:</p><ul><li>长文本触发滚动能力。</li><li>光标移动触发自动滚动。</li></ul></li><li><p><strong>边界情况</strong>:</p><ul><li>空文本。</li><li>快速输入。</li></ul></li></ol>',5))])}const A=i(s,[["render",g]]);export{_ as __pageData,A as default};
