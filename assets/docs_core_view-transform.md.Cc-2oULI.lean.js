var o=Object.defineProperty;var l=(i,s)=>o(i,"name",{value:s,configurable:!0});import{_ as c,C as r,c as d,o as g,ai as m,G as n,j as a,a as t}from"./chunks/framework.BnOgjZe9.js";const z=JSON.parse('{"title":"视图变换","description":"","frontmatter":{"title":"视图变换"},"headers":[],"relativePath":"docs/core/view-transform.md","filePath":"docs/core/view-transform.md"}'),h={name:"docs/core/view-transform.md"};function y(i,s,u,b,I,x){const p=r("InkMermaidBlock"),e=r("InkCodeBlock");return g(),d("div",null,[s[0]||(s[0]=m("",13)),n(p,{"code-base64":"Z3JhcGggVEQKICAgIHN1YmdyYXBoIFBpcGVsaW5lIFvmuLLmn5PnrqHnur9dCiAgICAgICAgQVtMYXlvdXQgUGhhc2VdIC0tPnxDb21wdXRlIE9mZnNldHwgQltQYWludCBQaGFzZV0KICAgICAgICBCIC0tPiBDe0hhcyBUcmFuc2Zvcm0/fQogICAgICAgIEMgLS0+fFllc3wgRFtBcHBseSBNYXRyaXhdCiAgICAgICAgQyAtLT58Tm98IEVbUGFpbnQgU2VsZl0KICAgICAgICBEIC0tPiBFCiAgICAgICAgRSAtLT4gRltQYWludCBDaGlsZHJlbl0KICAgIGVuZAo="}),s[1]||(s[1]=a("h3",{id:"_2-3-核心算法",tabindex:"-1"},[t("2.3 核心算法 "),a("a",{class:"header-anchor",href:"#_2-3-核心算法","aria-label":'Permalink to "2.3 核心算法"'},"​")],-1)),s[2]||(s[2]=a("p",null,"Inkwell 使用 3x2 的仿射变换矩阵（Affine Transform Matrix）来描述 2D 空间中的平移、缩放和旋转。",-1)),s[3]||(s[3]=a("h4",{id:"_2-3-1-矩阵乘法-forward-transform",tabindex:"-1"},[t("2.3.1 矩阵乘法 (Forward Transform) "),a("a",{class:"header-anchor",href:"#_2-3-1-矩阵乘法-forward-transform","aria-label":'Permalink to "2.3.1 矩阵乘法 (Forward Transform)"'},"​")],-1)),s[4]||(s[4]=a("p",null,"从局部空间到世界空间的转换遵循以下公式：",-1)),n(e,{"code-base64":"TV97d29ybGR9ID0gTV97cGFyZW50fSBcdGltZXMgTV97bG9jYWx9Cg==",lang:"math",meta:""}),s[5]||(s[5]=m("",6)),n(e,{"code-base64":"eCcgPSBhIFxjZG90IHggKyBjIFxjZG90IHkgKyB0eAp5JyA9IGIgXGNkb3QgeCArIGQgXGNkb3QgeSArIHR5Cg==",lang:"math",meta:""}),s[6]||(s[6]=a("h2",{id:"_3-源码解析",tabindex:"-1"},[t("3. 源码解析 "),a("a",{class:"header-anchor",href:"#_3-源码解析","aria-label":'Permalink to "3. 源码解析"'},"​")],-1)),s[7]||(s[7]=a("p",null,"以下代码用于说明变换逻辑的关键步骤（为便于阅读做了简化）。真实实现请以 [base.ts](file:///Users/edeink/Documents/inkwell/src/core/base.ts) 与 [viewport.ts](file:///Users/edeink/Documents/inkwell/src/core/viewport/viewport.ts) 为准。",-1)),s[8]||(s[8]=a("h3",{id:"_3-1-widget-paint-base-ts",tabindex:"-1"},[t("3.1 Widget.paint (base.ts) "),a("a",{class:"header-anchor",href:"#_3-1-widget-paint-base-ts","aria-label":'Permalink to "3.1 Widget.paint (base.ts)"'},"​")],-1)),s[9]||(s[9]=a("p",null,[a("code",null,"Widget"),t(" 基类负责维护世界矩阵并管理渲染上下文的保存与恢复。")],-1)),n(e,{"code-base64":"Ly8gc3JjL2NvcmUvYmFzZS50cwoKcGFpbnQoY29udGV4dDogQnVpbGRDb250ZXh0KTogdm9pZCB7CiAgLy8gMS4g6I635Y+W5bGA6YOo5Y+Y5o2i5q2l6aqkICjpgJrluLjmmK/luIPlsYDlgY/np7spCiAgY29uc3Qgc3RlcHMgPSB0aGlzLmdldFNlbGZUcmFuc2Zvcm1TdGVwcygpOyAvLyBbeyB0OiAndHJhbnNsYXRlJywgeDogb2Zmc2V0LmR4LCB5OiBvZmZzZXQuZHkgfV0KICAKICAvLyAyLiDorqHnrpflvZPliY3oioLngrnnmoTkuJbnlYznn6npmLUKICBjb25zdCBwcmV2ID0gY29udGV4dC53b3JsZE1hdHJpeCA/PyBJREVOVElUWV9NQVRSSVg7CiAgY29uc3QgbmV4dCA9IG11bHRpcGx5KHByZXYsIGNvbXBvc2VTdGVwcyhzdGVwcykpOwogIHRoaXMuX3dvcmxkTWF0cml4ID0gbmV4dDsgLy8g57yT5a2Y55+p6Zi15L6bIEhpdFRlc3Qg5L2/55SoCgogIC8vIDMuIOW6lOeUqOWPmOaNouWIsOa4suafk+WZqCAoQ2FudmFzIENvbnRleHQpCiAgY29udGV4dC5yZW5kZXJlcj8uc2F2ZT8uKCk7CiAgYXBwbHlTdGVwcyhjb250ZXh0LnJlbmRlcmVyLCBzdGVwcyk7CgogIC8vIDQuIOe7mOWItuiHqui6qwogIHRoaXMucGFpbnRTZWxmKHsgLi4uY29udGV4dCwgd29ybGRNYXRyaXg6IG5leHQgfSk7CgogIC8vIDUuIOe7mOWItuWtkOe7hOS7tgogIGZvciAoY29uc3QgY2hpbGQgb2YgdGhpcy5jaGlsZHJlbikgewogICAgY2hpbGQucGFpbnQoeyAuLi5jb250ZXh0LCB3b3JsZE1hdHJpeDogbmV4dCB9KTsKICB9CgogIC8vIDYuIOaBouWkjea4suafk+WZqOeKtuaAgQogIGNvbnRleHQucmVuZGVyZXI/LnJlc3RvcmU/LigpOwp9Cg==",lang:"typescript",meta:""}),s[10]||(s[10]=a("h3",{id:"_3-2-hittest-实现",tabindex:"-1"},[t("3.2 HitTest 实现 "),a("a",{class:"header-anchor",href:"#_3-2-hittest-实现","aria-label":'Permalink to "3.2 HitTest 实现"'},"​")],-1)),s[11]||(s[11]=a("p",null,"利用缓存的世界矩阵进行逆变换，实现精准的点击检测。",-1)),n(e,{"code-base64":"Ly8gc3JjL2NvcmUvYmFzZS50cwoKcHVibGljIGhpdFRlc3QoeDogbnVtYmVyLCB5OiBudW1iZXIpOiBib29sZWFuIHsKICBpZiAodGhpcy5fd29ybGRNYXRyaXgpIHsKICAgIC8vIDEuIOiuoeeul+mAhuefqemYte+8iOW5tuWPr+e8k+WtmOS7peWHj+WwkemHjeWkjeiuoeeul++8iQogICAgY29uc3QgaW52ID0gaW52ZXJ0KHRoaXMuX3dvcmxkTWF0cml4KTsKICAgIC8vIDIuIOWwhuWFqOWxgOWdkOagh+i9rOaNouS4uuWxgOmDqOWdkOaghwogICAgY29uc3QgbG9jYWwgPSB0cmFuc2Zvcm1Qb2ludChpbnYsIHsgeCwgeSB9KTsKICAgIAogICAgLy8gMy4g5qOA5p+l54K55piv5ZCm5Zyo55+p5b2i6IyD5Zu05YaFCiAgICBjb25zdCB3ID0gdGhpcy5yZW5kZXJPYmplY3Quc2l6ZS53aWR0aDsKICAgIGNvbnN0IGggPSB0aGlzLnJlbmRlck9iamVjdC5zaXplLmhlaWdodDsKICAgIHJldHVybiBsb2NhbC54ID49IDAgJiYgbG9jYWwueSA+PSAwICYmIGxvY2FsLnggPD0gdyAmJiBsb2NhbC55IDw9IGg7CiAgfQogIHJldHVybiBmYWxzZTsKfQo=",lang:"typescript",meta:""}),s[12]||(s[12]=m("",6)),n(e,{"code-base64":"Ly8gc3JjL2NvcmUvdmlld3BvcnQvdmlld3BvcnQudHMKCnBhaW50KGNvbnRleHQ6IEJ1aWxkQ29udGV4dCk6IHZvaWQgewogIC8vIC4uLiAo55yB55Wl6Ieq6Lqr57uY5Yi25Luj56CBKSAuLi4KCiAgLy8g5a6a5LmJ6KeG5Y+j5Y+Y5o2i5q2l6aqkCiAgLy8g5rOo5oSP77yaSW5rd2VsbCDnmoTnn6npmLXnu4TlkIjph4fnlKjigJzlkI7kuZjigJ3vvIhtID0gbSAqIHN0ZXBNYXRyaXjvvInvvIzlm6DmraQgc3RlcHMg5pWw57uE5Lit5ZCO6Z2i55qE5Y+Y5o2i5Lya5pu05pep5L2c55So5LqO54K544CCCiAgLy8g5L6L5aaC77yadmlld1N0ZXBzID0gW3RyYW5zbGF0ZSwgc2NhbGVdIOe7hOWQiOefqemYteaYryBUICogU++8jOWvueeCueeahOaViOaenOaYr+KAnOWFiOe8qeaUvu+8jOWGjeW5s+enu+KAneOAggogIGNvbnN0IHZpZXdTdGVwczogVHJhbnNmb3JtU3RlcFtdID0gWwogICAgeyB0OiAndHJhbnNsYXRlJywgeDogdGhpcy5fdHgsIHk6IHRoaXMuX3R5IH0sCiAgICB7IHQ6ICdzY2FsZScsIHN4OiB0aGlzLl9zY2FsZSwgc3k6IHRoaXMuX3NjYWxlIH0sCiAgXTsKCiAgLy8g5bqU55So6KeG5Y+j5Y+Y5o2i5Yiw5riy5p+T5ZmoCiAgYXBwbHlTdGVwcyhjb250ZXh0LnJlbmRlcmVyLCB2aWV3U3RlcHMpOwoKICAvLyDmm7TmlrDlrZDnu4Tku7bnmoTkuJbnlYznn6npmLUKICBjb25zdCB2aWV3TG9jYWwgPSBjb21wb3NlU3RlcHModmlld1N0ZXBzKTsKICAvLyBjaGlsZE1hdHJpeCA9IHBhcmVudE1hdHJpeCAqIHZpZXdNYXRyaXgKICBjb25zdCBjaGlsZE1hdHJpeCA9IG11bHRpcGx5KHRoaXMuX3dvcmxkTWF0cml4ISwgdmlld0xvY2FsKTsKCiAgLy8g57uY5Yi25a2Q57uE5Lu2ICjlhoXlrrkpCiAgLy8g5rOo5oSP77ya5a2Q57uE5Lu26YCa5bi46L+Y5pyJ6Ieq6Lqr55qE5rua5Yqo5YGP56e7ICgtc2Nyb2xsWCwgLXNjcm9sbFkpCiAgZm9yIChjb25zdCBjaGlsZCBvZiBjaGlsZHJlbikgewogICAgY2hpbGQucGFpbnQoeyAuLi5jb250ZXh0LCB3b3JsZE1hdHJpeDogY2hpbGRNYXRyaXggfSk7CiAgfQogIAogIC8vIC4uLgp9Cg==",lang:"typescript",meta:""}),s[13]||(s[13]=a("h3",{id:"_4-3-数学验证",tabindex:"-1"},[t("4.3 数学验证 "),a("a",{class:"header-anchor",href:"#_4-3-数学验证","aria-label":'Permalink to "4.3 数学验证"'},"​")],-1)),n(p,{"code-base64":"Z3JhcGggTFIKICAgIFBfY29udGVudFtQIGNvbnRlbnRdIC0tPnxUcmFuc2xhdGUgLXNjcm9sbHwgUF9zY3JvbGxlZAogICAgUF9zY3JvbGxlZCAtLT58U2NhbGUgc3wgUF9zY2FsZWQKICAgIFBfc2NhbGVkIC0tPnxUcmFuc2xhdGUgdHgsdHl8IFBfc2NyZWVuW1Agc2NyZWVuXQo="}),s[14]||(s[14]=m("",9))])}l(y,"_sfc_render");const w=c(h,[["render",y]]);export{z as __pageData,w as default};
