import{_ as a,C as s,c,o as n,ai as d,j as o,a as t,G as r}from"./chunks/framework.Ckc8SVM3.js";const k=JSON.parse('{"title":"Inkwell DevTools","description":"","frontmatter":{},"headers":[],"relativePath":"src/devtools/README.md","filePath":"src/devtools/README.md"}'),i={name:"src/devtools/README.md"};function u(h,e,g,m,v,p){const l=s("InkCodeBlock");return n(),c("div",null,[e[3]||(e[3]=d('<h1 id="inkwell-devtools" tabindex="-1">Inkwell DevTools <a class="header-anchor" href="#inkwell-devtools" aria-label="Permalink to &quot;Inkwell DevTools&quot;">​</a></h1><p>Inkwell DevTools 是 <code>@edeink/inkwell</code> 框架的调试工具，提供组件树查看、属性编辑、元素高亮与交互式拾取功能。</p><h2 id="_1-项目整体架构" tabindex="-1">1. 项目整体架构 <a class="header-anchor" href="#_1-项目整体架构" aria-label="Permalink to &quot;1. 项目整体架构&quot;">​</a></h2><p>DevTools 采用 React + Ant Design 构建，作为一个独立的覆盖层（Overlay）挂载到应用中。它通过 <code>Runtime</code> 单例与核心框架进行通信。</p><ul><li><strong>入口层</strong>: <code>src/devtools/index.tsx</code>。负责单例管理 (<code>Devtools</code> class) 和 React 根节点挂载。</li><li><strong>UI 层</strong>: <code>src/devtools/components/</code>。包含面板布局 (<code>LayoutPanel</code>)、树视图、属性编辑器等。</li><li><strong>逻辑层</strong>: <code>src/devtools/hooks/</code>。<code>useMouseInteraction</code> 处理画布交互，<code>useDevtoolsHotkeys</code> 处理快捷键。</li><li><strong>数据转换</strong>: <code>src/devtools/helper/tree.ts</code>。将 Inkwell Widget 树转换为 UI 可用的树结构。</li></ul><h2 id="_2-主要组件及其功能" tabindex="-1">2. 主要组件及其功能 <a class="header-anchor" href="#_2-主要组件及其功能" aria-label="Permalink to &quot;2. 主要组件及其功能&quot;">​</a></h2><table tabindex="0"><thead><tr><th>组件</th><th>路径</th><th>描述</th></tr></thead><tbody><tr><td><strong>DevTools</strong></td><td><code>src/devtools/index.tsx</code></td><td>对外暴露的 React 组件，作为单例的启动入口。</td></tr><tr><td><strong>DevToolsPanel</strong></td><td><code>src/devtools/components/DevToolsPanel.tsx</code></td><td>(重构后) 核心面板组件，包含树、搜索、交互逻辑。</td></tr><tr><td><strong>LayoutPanel</strong></td><td><code>src/devtools/components/layout/index.tsx</code></td><td>提供可拖拽、停靠 (Dock) 的布局容器。</td></tr><tr><td><strong>Overlay</strong></td><td><code>src/devtools/components/overlay/index.ts</code></td><td>负责在 Canvas 上绘制高亮边框和提示信息。</td></tr><tr><td><strong>PropsEditor</strong></td><td><code>src/devtools/components/props-editor/index.tsx</code></td><td>显示并编辑当前选中 Widget 的属性。</td></tr></tbody></table><h2 id="_3-核心-api-接口" tabindex="-1">3. 核心 API 接口 <a class="header-anchor" href="#_3-核心-api-接口" aria-label="Permalink to &quot;3. 核心 API 接口&quot;">​</a></h2><h3 id="devtools-singleton-class" tabindex="-1"><code>Devtools</code> (Singleton Class) <a class="header-anchor" href="#devtools-singleton-class" aria-label="Permalink to &quot;`Devtools` (Singleton Class)&quot;">​</a></h3><p>管理 DevTools 面板的生命周期。</p><ul><li><code>getInstance(props?)</code>: 获取或创建单例。</li><li><code>show() / hide()</code>: 控制面板显示/隐藏。</li><li><code>dispose()</code>: 销毁实例，清理 DOM。</li><li><code>update(props?)</code>: 更新属性。</li></ul><h3 id="usemouseinteraction-hook" tabindex="-1"><code>useMouseInteraction</code> (Hook) <a class="header-anchor" href="#usemouseinteraction-hook" aria-label="Permalink to &quot;`useMouseInteraction` (Hook)&quot;">​</a></h3><p>处理鼠标在 Canvas 上的移动和点击事件。</p><ul><li><strong>输入</strong>: <code>runtime</code>, <code>overlay</code>, <code>active</code> (是否开启 inspect)。</li><li><strong>输出</strong>: <code>onPick</code> (选中回调), <code>runtimeId</code> (当前画布 ID)。</li><li><strong>功能</strong>: 利用 <code>hitTest</code> 识别鼠标下的 Widget，并调用 <code>overlay</code> 高亮。</li></ul><h2 id="_4-重要数据结构和状态管理" tabindex="-1">4. 重要数据结构和状态管理 <a class="header-anchor" href="#_4-重要数据结构和状态管理" aria-label="Permalink to &quot;4. 重要数据结构和状态管理&quot;">​</a></h2><h3 id="widget-tree-transformation" tabindex="-1">Widget Tree Transformation <a class="header-anchor" href="#widget-tree-transformation" aria-label="Permalink to &quot;Widget Tree Transformation&quot;">​</a></h3>',16)),o("ul",null,[e[2]||(e[2]=o("li",null,[o("strong",null,[o("code",null,"Widget"),t(" (Core)")]),t(": 运行时组件节点。")],-1)),o("li",null,[e[0]||(e[0]=o("strong",null,[o("code",null,"DevTreeNode"),t(" (DevTools)")],-1)),e[1]||(e[1]=t(": 轻量级树节点，用于 Antd Tree 展示。",-1)),r(l,{"code-base64":"dHlwZSBEZXZUcmVlTm9kZSA9IHsKICBrZXk6IHN0cmluZzsKICB0eXBlOiBzdHJpbmc7CiAgcHJvcHM/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjsKICBjaGlsZHJlbjogRGV2VHJlZU5vZGVbXTsKfTsK",lang:"ts",meta:""})])]),e[4]||(e[4]=d('<h3 id="state-management" tabindex="-1">State Management <a class="header-anchor" href="#state-management" aria-label="Permalink to &quot;State Management&quot;">​</a></h3><p>DevTools 内部使用 React <code>useState</code> 管理状态，不依赖外部 Redux/MobX。</p><ul><li><code>selected</code>: 当前选中的 Widget。</li><li><code>expandedKeys</code>: 树的展开状态。</li><li><code>runtime</code>: 当前调试的 Runtime 实例。</li></ul><h2 id="_5-关键业务逻辑流程" tabindex="-1">5. 关键业务逻辑流程 <a class="header-anchor" href="#_5-关键业务逻辑流程" aria-label="Permalink to &quot;5. 关键业务逻辑流程&quot;">​</a></h2><h3 id="inspect-拾取-流程" tabindex="-1">Inspect (拾取) 流程 <a class="header-anchor" href="#inspect-拾取-流程" aria-label="Permalink to &quot;Inspect (拾取) 流程&quot;">​</a></h3><ol><li>用户点击 &quot;Inspect&quot; 按钮 (<code>activeInspect = true</code>)。</li><li><code>useMouseInteraction</code> 监听 <code>mousemove</code>。</li><li>调用 <code>Runtime</code> 的 <code>hitTest</code> 获取鼠标下的 Widget。</li><li>调用 <code>Overlay.highlight(widget)</code> 绘制高亮框。</li><li>用户点击 <code>click</code> -&gt; 触发 <code>onPick(widget)</code>。</li><li><code>DevToolsPanel</code> 更新 <code>selected</code>，计算路径并展开树节点 (<code>setExpandedKeys</code>)。</li><li><code>Tree</code> 组件滚动到对应节点。</li></ol><h3 id="tree-联动流程" tabindex="-1">Tree 联动流程 <a class="header-anchor" href="#tree-联动流程" aria-label="Permalink to &quot;Tree 联动流程&quot;">​</a></h3><ol><li><code>Runtime</code> 发生变化 (如 <code>rebuild</code>)。</li><li><code>DevToolsPanel</code> 重新计算 <code>treeData</code> (<code>toTree</code>)。</li><li><code>Tree</code> 组件刷新展示。</li><li>用户在 <code>Tree</code> 中 Hover/Select -&gt; 触发 <code>findWidget</code> 查找 Widget -&gt; 调用 <code>Overlay</code> 高亮。</li></ol>',8))])}const b=a(i,[["render",u]]);export{k as __pageData,b as default};
