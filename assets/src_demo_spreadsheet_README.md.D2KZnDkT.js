var t=Object.defineProperty;var r=(a,e)=>t(a,"name",{value:e,configurable:!0});import{_ as d,C as n,c,o as s,j as l,G as g,ai as I,a as o}from"./chunks/framework.BnOgjZe9.js";const b=JSON.parse('{"title":"电子表格 (Spreadsheet)","description":"","frontmatter":{},"headers":[],"relativePath":"src/demo/spreadsheet/README.md","filePath":"src/demo/spreadsheet/README.md"}'),C={name:"src/demo/spreadsheet/README.md"};function A(a,e,u,h,p,S){const i=n("InkCodeBlock");return s(),c("div",null,[e[0]||(e[0]=l("h1",{id:"电子表格-spreadsheet",tabindex:"-1"},[o("电子表格 (Spreadsheet) "),l("a",{class:"header-anchor",href:"#电子表格-spreadsheet","aria-label":'Permalink to "电子表格 (Spreadsheet)"'},"​")],-1)),e[1]||(e[1]=l("p",null,[o("这是一个基于 "),l("code",null,"@edeink/inkwell"),o(" 框架构建的高性能电子表格演示项目，展示了处理百万级数据渲染、稀疏矩阵存储和公式计算引擎的能力。")],-1)),e[2]||(e[2]=l("h2",{id:"目录结构",tabindex:"-1"},[o("目录结构 "),l("a",{class:"header-anchor",href:"#目录结构","aria-label":'Permalink to "目录结构"'},"​")],-1)),g(i,{"code-base64":"c3JjL2RlbW8vc3ByZWFkc2hlZXQvCuKUnOKUgOKUgCBfX3Rlc3RzX18vICAgICAgICAgICAgICAgICAgIyDmtYvor5XnlKjkvosK4pSc4pSA4pSAIGNvbXBvbmVudHMvICAgICAgICAgICAgICAgICAjIFJlYWN0IFVJIOe7hOS7tiAo5aaC5bel5YW35qCPKQrilIIgICDilJzilIDilIAgc3ByZWFkc2hlZXQtdG9vbGJhci8K4pSCICAg4pSU4pSA4pSAIC4uLgrilJzilIDilIAgd2lkZ2V0cy8gICAgICAgICAgICAgICAgICAgICMgSW5rd2VsbCBXaWRnZXQg57uE5Lu2CuKUgiAgIOKUnOKUgOKUgCBjb2wtaGVhZGVyLnRzeCAgICAgICAgICAjIOWIl+WktOe7hOS7tgrilIIgICDilJzilIDilIAgcm93LWhlYWRlci50c3ggICAgICAgICAgIyDooYzlpLTnu4Tku7YK4pSCICAg4pSc4pSA4pSAIGNvcm5lci50c3ggICAgICAgICAgICAgICMg5bem5LiK6KeS56m655m95Z2XCuKUgiAgIOKUnOKUgOKUgCBncmlkLnRzeCAgICAgICAgICAgICAgICAjIOe9keagvOS4u+S9k+a4suafk+e7hOS7tgrilIIgICDilJzilIDilIAgZWRpdGFibGUtdGV4dC50c3ggICAgICAgIyDljZXlhYPmoLznvJbovpHnu4Tku7YK4pSCICAg4pSU4pSA4pSAIC4uLgrilJzilIDilIAgYXBwLnRzeCAgICAgICAgICAgICAgICAgICAgICMg5bqU55So5YWl5Y+jCuKUnOKUgOKUgCBpbmRleC50c3ggICAgICAgICAgICAgICAgICAgIyDlpJbpg6jmjILovb3ngrkK4pSc4pSA4pSAIHNwcmVhZHNoZWV0LW1vZGVsLnRzICAgICAgICAjIOaVsOaNruaooeWei+S4jumAu+i+keaguOW/gwrilJzilIDilIAgc3ByZWFkc2hlZXQudHN4ICAgICAgICAgICAgICMg6KGo5qC85Li75a655Zmo57uE5Lu2CuKUlOKUgOKUgCB0eXBlcy50cyAgICAgICAgICAgICAgICAgICAgIyDnsbvlnovlrprkuYkK",lang:"",meta:""}),e[3]||(e[3]=I('<h2 id="核心架构与实现" tabindex="-1">核心架构与实现 <a class="header-anchor" href="#核心架构与实现" aria-label="Permalink to &quot;核心架构与实现&quot;">​</a></h2><h3 id="_1-数据存储模型" tabindex="-1">1. 数据存储模型 <a class="header-anchor" href="#_1-数据存储模型" aria-label="Permalink to &quot;1. 数据存储模型&quot;">​</a></h3><p>为了高效处理大规模数据（例如百万行），项目采用稀疏矩阵模型存储数据：</p><ul><li><strong>SpreadsheetModel</strong>: 核心数据模型类。</li><li><strong>稀疏存储</strong>: 仅存储有数据的单元格 (<code>Map&lt;string, CellData&gt;</code>)，key 为行列坐标组合。</li><li><strong>SizeManager</strong>: 专门管理行高和列宽。 <ul><li>支持默认尺寸。</li><li>使用 <code>Map</code> 存储自定义尺寸的行/列。</li><li>提供 <code>O(1)</code> 或 <code>O(log N)</code> 的位置偏移计算 (<code>getOffset</code>) 和索引查找 (<code>getIndex</code>)。</li></ul></li></ul><h3 id="_2-渲染优化-虚拟化" tabindex="-1">2. 渲染优化 (虚拟化) <a class="header-anchor" href="#_2-渲染优化-虚拟化" aria-label="Permalink to &quot;2. 渲染优化 (虚拟化)&quot;">​</a></h3><p>表格渲染采用<strong>虚拟滚动 (Virtual Scrolling)</strong> 技术，仅渲染视口内的单元格：</p><ul><li><strong>SpreadsheetGrid</strong>: 负责计算可见区域 (<code>Viewport</code>)。 <ul><li>根据 <code>scrollY</code> 和 <code>scrollX</code> 计算起始行列 (<code>startRow</code>, <code>startCol</code>)。</li><li>根据视口尺寸计算结束行列。</li><li>仅遍历可见范围内的行列进行渲染，极大降低了 DOM/RenderObject 的数量。</li></ul></li><li><strong>增量更新</strong>: 利用 Inkwell 的 Diff 算法，仅更新变化的单元格。</li></ul><h3 id="_3-公式计算引擎" tabindex="-1">3. 公式计算引擎 <a class="header-anchor" href="#_3-公式计算引擎" aria-label="Permalink to &quot;3. 公式计算引擎&quot;">​</a></h3><p>内置了一个简单的递归下降公式解析器：</p><ul><li><strong>evaluateFormula</strong>: <ul><li>支持以 <code>=</code> 开头的公式。</li><li>支持单元格引用 (如 <code>A1</code>, <code>B2</code>)。</li><li>支持基础数学运算。</li><li><strong>递归求值</strong>: 当引用的单元格也是公式时，会递归计算其值。</li></ul></li></ul><h3 id="_4-交互与编辑" tabindex="-1">4. 交互与编辑 <a class="header-anchor" href="#_4-交互与编辑" aria-label="Permalink to &quot;4. 交互与编辑&quot;">​</a></h3><ul><li><strong>选择区域</strong>: 支持拖拽选择单元格区域 (<code>SelectionRange</code>)。</li><li><strong>单元格编辑</strong>: <ul><li>双击单元格进入编辑模式。</li><li><code>TextArea</code> 组件在 Canvas 上层覆盖一个真实 DOM 输入框，实现原生输入体验。</li><li>编辑完成后回写模型并触发重绘。</li></ul></li><li><strong>行列调整</strong>: 支持拖拽行头/列头边缘调整尺寸。</li></ul><h2 id="状态管理" tabindex="-1">状态管理 <a class="header-anchor" href="#状态管理" aria-label="Permalink to &quot;状态管理&quot;">​</a></h2><ul><li><strong>Spreadsheet (Controller)</strong>: 作为顶层组件，管理 <code>scrollX</code>, <code>scrollY</code>, <code>selection</code>, <code>editingCell</code> 等 UI 状态。</li><li><strong>Model-View 同步</strong>: <ul><li>UI 操作调用 <code>model</code> 方法更新数据。</li><li>通过 <code>setState</code> 或 <code>version</code> 字段强制触发视图更新。</li><li>支持外部数据版本控制 (<code>dataVersion</code>)。</li></ul></li></ul><h2 id="技术栈" tabindex="-1">技术栈 <a class="header-anchor" href="#技术栈" aria-label="Permalink to &quot;技术栈&quot;">​</a></h2><ul><li><strong>Framework</strong>: <code>@edeink/inkwell</code></li><li><strong>Data Structure</strong>: Sparse Matrix (稀疏矩阵)</li><li><strong>Algorithm</strong>: Virtual Scrolling (虚拟滚动), Recursive Descent Parser (递归下降解析)</li></ul>',16)),g(i,{"code-base64":"",lang:"",meta:""})])}r(A,"_sfc_render");const O=d(C,[["render",A]]);export{b as __pageData,O as default};
